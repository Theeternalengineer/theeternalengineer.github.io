<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wrapped — Adri / Pinki</title>
  <link rel="stylesheet" href="wrapped.css?v=1" />
</head>

<body>

  <!-- Home -->
  <a class="home-btn" href="index.html" aria-label="Volver al inicio">Home</a>

  <main class="wrapped" id="wrappedApp" aria-label="Wrapped en formato stories">

    <!-- Barra de progreso (20) -->
    <div class="progress" id="progress" aria-hidden="true"></div>

    <!-- Slides -->
    <section class="slide active" data-title="Intro">
      <div class="content">
        <p class="kicker">Tu 2025 en una historia</p>
        <h1 class="title">Adri / Pinki<br>Wrapped</h1>
        <p class="sub">Tap / click para avanzar · Flechas para navegar</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="0"></span></div>
    </section>

    <section class="slide" data-title="Tiempo juntos">
      <div class="content">
        <p class="kicker">Tiempo juntos</p>
        <h2 class="title">Desde el 18 de octubre de 2025</h2>

        <div class="statCard">
          <div class="statBig" id="sinceClock">—</div>
          <div class="statSmall">días · horas · min · seg</div>
        </div>

        <p class="note">Actualizándose en tiempo real</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="1"></span></div>
    </section>

    <section class="slide" data-title="Mensajes">
      <div class="content">
        <p class="kicker">Mensajes enviados</p>
        <h2 class="title">Lo nuestro también se escribe</h2>

        <div class="statCard">
          <div class="statBig" id="messagesCount">—</div>
          <div class="statSmall">mensajes (edítame en el JS)</div>
        </div>

        <p class="note">Dato simbólico o real, tú decides.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="2"></span></div>
    </section>

    <!-- 3 slides de frases -->
    <section class="slide" data-title="Frase 1">
      <div class="content">
        <p class="kicker">Frase más icónica #1</p>
        <h2 class="title" id="phrase1Text">“(pon aquí la frase 1)”</h2>

        <div class="statCard">
          <div class="statBig" id="phrase1Count">—</div>
          <div class="statSmall">veces</div>
        </div>

        <p class="note">Slide 1 de 3 de frases.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="3"></span></div>
    </section>

    <section class="slide" data-title="Frase 2">
      <div class="content">
        <p class="kicker">Frase más icónica #2</p>
        <h2 class="title" id="phrase2Text">“(pon aquí la frase 2)”</h2>

        <div class="statCard">
          <div class="statBig" id="phrase2Count">—</div>
          <div class="statSmall">veces</div>
        </div>

        <p class="note">Slide 2 de 3 de frases.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="4"></span></div>
    </section>

    <section class="slide" data-title="Frase 3">
      <div class="content">
        <p class="kicker">Frase más icónica #3</p>
        <h2 class="title" id="phrase3Text">“(pon aquí la frase 3)”</h2>

        <div class="statCard">
          <div class="statBig" id="phrase3Count">—</div>
          <div class="statSmall">veces</div>
        </div>

        <p class="note">Slide 3 de 3 de frases.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="5"></span></div>
    </section>

    <!-- (Opcional) 4 slides “puente” antes del Top 5 -->
    <section class="slide" data-title="Highlight 1">
      <div class="content">
        <p class="kicker">Highlight</p>
        <h2 class="title">La parte donde todo se sintió simple</h2>
        <p class="body">Texto placeholder. Aquí va una línea emocional corta.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="6"></span></div>
    </section>

    <section class="slide" data-title="Highlight 2">
      <div class="content">
        <p class="kicker">Highlight</p>
        <h2 class="title">La parte donde nos elegimos</h2>
        <p class="body">Texto placeholder. Mantén 1–2 líneas máximo.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="7"></span></div>
    </section>

    <section class="slide" data-title="Highlight 3">
      <div class="content">
        <p class="kicker">Highlight</p>
        <h2 class="title">La parte donde el mundo bajó el volumen</h2>
        <p class="body">Texto placeholder. Aquí cabe un recuerdo corto.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="8"></span></div>
    </section>

    <section class="slide" data-title="Antes del Top 5">
      <div class="content">
        <p class="kicker">Ahora sí</p>
        <h2 class="title">Top 5 momentos</h2>
        <p class="body">Cinco stories, cinco recuerdos. Uno por pantalla.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="9"></span></div>
    </section>

    <!-- Top 5 momentos (5 slides) -->
    <section class="slide" data-title="Top 1">
      <div class="content">
        <p class="kicker">Top 1</p>
        <h2 class="title">(Momento 1)</h2>
        <p class="body">Descripción breve (1–2 líneas). Qué pasó y por qué se quedó.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="10"></span></div>
    </section>

    <section class="slide" data-title="Top 2">
      <div class="content">
        <p class="kicker">Top 2</p>
        <h2 class="title">(Momento 2)</h2>
        <p class="body">Descripción breve (1–2 líneas).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="11"></span></div>
    </section>

    <section class="slide" data-title="Top 3">
      <div class="content">
        <p class="kicker">Top 3</p>
        <h2 class="title">(Momento 3)</h2>
        <p class="body">Descripción breve (1–2 líneas).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="12"></span></div>
    </section>

    <section class="slide" data-title="Top 4">
      <div class="content">
        <p class="kicker">Top 4</p>
        <h2 class="title">(Momento 4)</h2>
        <p class="body">Descripción breve (1–2 líneas).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="13"></span></div>
    </section>

    <section class="slide" data-title="Top 5">
      <div class="content">
        <p class="kicker">Top 5</p>
        <h2 class="title">(Momento 5)</h2>
        <p class="body">Descripción breve (1–2 líneas).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="14"></span></div>
    </section>

    <!-- 4 slides extra para completar 20 -->
    <section class="slide" data-title="Recap 1">
      <div class="content">
        <p class="kicker">Recap</p>
        <h2 class="title">Lo que nos sostiene</h2>
        <p class="body">Texto placeholder (emocional, nivel medio, sin groserías).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="15"></span></div>
    </section>

    <section class="slide" data-title="Recap 2">
      <div class="content">
        <p class="kicker">Recap</p>
        <h2 class="title">Lo que aprendimos</h2>
        <p class="body">Texto placeholder (1–2 líneas).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="16"></span></div>
    </section>

    <section class="slide" data-title="Recap 3">
      <div class="content">
        <p class="kicker">Recap</p>
        <h2 class="title">Lo que viene</h2>
        <p class="body">Texto placeholder (1–2 líneas).</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="17"></span></div>
    </section>

    <!-- Cierre -->
    <section class="slide" data-title="Cierre">
      <div class="content">
        <p class="kicker">Final</p>
        <h2 class="title">Por más recuerdos juntos en 2026</h2>
        <p class="body">y apuntando a una vida llena de recuerdos.</p>

        <div class="ctaRow">
          <button class="cta" id="restartBtn" type="button">Regresar al inicio</button>
          <button class="cta ctaGhost" id="nextSectionBtn" type="button">Siguiente sección</button>
        </div>

        <p class="note">El botón “Siguiente sección” queda listo para que lo conectemos a lo que siga.</p>
      </div>
      <div class="song">Canción: <span class="songName" data-song-index="18"></span></div>
    </section>

  </main>

  <script>
    (function () {
      // =========================
      // Config editable (aquí metes datos reales)
      // =========================
      const CONFIG = {
        // Inicio relación (zona -06:00 para que sea consistente con tu contexto)
        startDateISO: "2025-10-18T00:00:00-06:00",

        // Mensajes enviados (placeholder)
        messagesSent: 0,

        // Frases (3 slides)
        phrases: [
          { text: "(pon aquí la frase 1)", count: 0 },
          { text: "(pon aquí la frase 2)", count: 0 },
          { text: "(pon aquí la frase 3)", count: 0 },
        ],

        // Canción por story (20). Déjalas pendientes y luego rellenas.
        songs: [
          "Pendiente (Story 1)",
          "Pendiente (Story 2)",
          "Pendiente (Story 3)",
          "Pendiente (Story 4)",
          "Pendiente (Story 5)",
          "Pendiente (Story 6)",
          "Pendiente (Story 7)",
          "Pendiente (Story 8)",
          "Pendiente (Story 9)",
          "Pendiente (Story 10)",
          "Pendiente (Story 11)",
          "Pendiente (Story 12)",
          "Pendiente (Story 13)",
          "Pendiente (Story 14)",
          "Pendiente (Story 15)",
          "Pendiente (Story 16)",
          "Pendiente (Story 17)",
          "Pendiente (Story 18)",
          "Pendiente (Story 19)",
          "Pendiente (Story 20)",
        ],

        // Timing
        defaultStoryMs: 5200, // auto-avance
      };

      // =========================
      // DOM
      // =========================
      const app = document.getElementById("wrappedApp");
      const slides = Array.from(document.querySelectorAll(".slide"));
      const progress = document.getElementById("progress");

      // UI targets
      const sinceClock = document.getElementById("sinceClock");
      const messagesCount = document.getElementById("messagesCount");

      const phrase1Text = document.getElementById("phrase1Text");
      const phrase2Text = document.getElementById("phrase2Text");
      const phrase3Text = document.getElementById("phrase3Text");

      const phrase1Count = document.getElementById("phrase1Count");
      const phrase2Count = document.getElementById("phrase2Count");
      const phrase3Count = document.getElementById("phrase3Count");

      const restartBtn = document.getElementById("restartBtn");
      const nextSectionBtn = document.getElementById("nextSectionBtn");

      // =========================
      // Init content
      // =========================
      // Messages
      messagesCount.textContent = String(CONFIG.messagesSent);

      // Phrases
      phrase1Text.textContent = `“${CONFIG.phrases[0].text}”`;
      phrase2Text.textContent = `“${CONFIG.phrases[1].text}”`;
      phrase3Text.textContent = `“${CONFIG.phrases[2].text}”`;

      phrase1Count.textContent = String(CONFIG.phrases[0].count);
      phrase2Count.textContent = String(CONFIG.phrases[1].count);
      phrase3Count.textContent = String(CONFIG.phrases[2].count);

      // Songs (per slide label)
      document.querySelectorAll(".songName").forEach((el) => {
        const idx = Number(el.getAttribute("data-song-index"));
        el.textContent = CONFIG.songs[idx] ?? "Pendiente";
      });

      // =========================
      // Progress bars
      // =========================
      const bars = [];
      for (let i = 0; i < slides.length; i++) {
        const bar = document.createElement("div");
        bar.className = "bar";
        const fill = document.createElement("div");
        fill.className = "fill";
        bar.appendChild(fill);
        progress.appendChild(bar);
        bars.push({ bar, fill });
      }

      // =========================
      // Stories engine
      // =========================
      let current = 0;
      let timer = null;

      function clearTimer() {
        if (timer) {
          window.clearTimeout(timer);
          timer = null;
        }
      }

      function setBarState(index) {
        bars.forEach((b, i) => {
          b.bar.classList.toggle("active", i === index);
          b.bar.classList.toggle("done", i < index);
          // reset fill animation
          b.fill.style.animation = "none";
          // force reflow
          void b.fill.offsetWidth;
        });
      }

      function animateActiveBar(durationMs) {
        const b = bars[current];
        if (!b) return;
        b.fill.style.animation = `fill ${durationMs}ms linear forwards`;
      }

      function show(index, { autoplay = true } = {}) {
        if (index < 0) index = 0;
        if (index >= slides.length) index = slides.length - 1;

        clearTimer();

        slides.forEach((s, i) => s.classList.toggle("active", i === index));
        current = index;

        setBarState(current);

        // Auto-advance except last slide (deja que cierre se disfrute)
        const isLast = current === slides.length - 1;
        const duration = CONFIG.defaultStoryMs;

        if (autoplay && !isLast) {
          animateActiveBar(duration);
          timer = window.setTimeout(() => {
            next();
          }, duration);
        } else {
          // marca barra como llena si no hay autoplay
          bars[current].fill.style.animation = "none";
        }
      }

      function next() {
        if (current < slides.length - 1) show(current + 1, { autoplay: true });
      }

      function prev() {
        if (current > 0) show(current - 1, { autoplay: true });
      }

      // Click navigation (izq = prev, der = next)
      app.addEventListener("click", (e) => {
        // Evitar interferencia con botones CTA
        const target = e.target;
        if (target && (target.tagName === "BUTTON" || target.closest("button"))) return;

        const x = e.clientX;
        const w = window.innerWidth;

        if (x < w * 0.28) prev();
        else next();
      });

      // Keyboard navigation
      window.addEventListener("keydown", (e) => {
        if (e.key === "ArrowRight" || e.key === " " || e.key === "Enter") {
          e.preventDefault();
          next();
        }
        if (e.key === "ArrowLeft") {
          e.preventDefault();
          prev();
        }
      });

      // CTA
      if (restartBtn) {
        restartBtn.addEventListener("click", () => show(0, { autoplay: true }));
      }
      if (nextSectionBtn) {
        nextSectionBtn.addEventListener("click", () => {
          // Placeholder: aquí después lo conectamos a otra página o sección
          // window.location.href = "next.html";
          alert("Siguiente sección: listo para conectarse.");
        });
      }

      // =========================
      // Live clock since 2025-10-18
      // =========================
      const startMs = new Date(CONFIG.startDateISO).getTime();

      function pad2(n) {
        return String(n).padStart(2, "0");
      }

      function tickClock() {
        const now = Date.now();
        let diff = Math.max(0, now - startMs);

        const sec = Math.floor(diff / 1000);
        const days = Math.floor(sec / 86400);
        const hours = Math.floor((sec % 86400) / 3600);
        const mins = Math.floor((sec % 3600) / 60);
        const s = sec % 60;

        // Formato: "X días · HH:MM:SS"
        sinceClock.textContent = `${days} días · ${pad2(hours)}:${pad2(mins)}:${pad2(s)}`;
      }

      tickClock();
      window.setInterval(tickClock, 1000);

      // Start
      show(0, { autoplay: true });

    })();
  </script>

</body>
</html>
